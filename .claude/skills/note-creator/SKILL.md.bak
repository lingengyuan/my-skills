# note-creator (Orchestrator Skill)

## Purpose
Given a short user prompt (and optional raw context), this skill MUST:

1) Classify intent and decide artifact types
2) Select a destination folder and stable naming
3) Invoke underlying format skills with runtime context
4) WRITE all generated artifacts to disk following a strict contract

This skill is an ORCHESTRATOR.
Generating content without writing files is considered a FAILURE.

---

## Dependencies
This skill MUST delegate format correctness to:

- obsidian-markdown/SKILL.md
- json-canvas/SKILL.md
- obsidian-bases/SKILL.md

---

## Inputs
- user_prompt: a short sentence or paragraph describing what to record
- optional_context_files (optional): raw markdown or text provided by the user

---

## Output Contract

**CRITICAL: Output paths are relative to CURRENT WORKING DIRECTORY (CWD)**
- The CWD when the skill is invoked is the base (e.g., `F:/Project/Obsidian/`)
- All outputs MUST be written to: `<cwd>/outputs/<folder>/<title>/`
- DO NOT write to the skill's own directory
- When computing paths, always use the current working directory as the base

All outputs MUST be written to:

outputs/<folder>/<title>/
  - note.md (required)
  - diagram.canvas (optional)
  - table.base (optional)
  - meta.json (required)

Rules:
- <folder> MUST come from rules/folders.md
- <title> MUST follow rules/naming.rules.md
- Writing files is mandatory

---

## Algorithm (Strict Execution Checklist)

### 1) Read Inputs
- Read user_prompt
- Read any optional_context_files

### 2) Classify Intent
Produce a STRICT classification JSON according to rules/classify.intent.md.
The JSON MUST include:
- title
- folder
- artifact_plan (must include "md")
- tags (3–8)
- properties (category, created, modified, source)

### 3) Compute Output Paths- CRITICAL: Get the current working directory (CWD) first- CWD is the directory where the user invoked the skill (e.g., `F:/Project/Obsidian/`)- Compute all paths as relative to CWD:  - root_dir   = <cwd>/outputs/<folder>/<title>/  - note_path  = <cwd>/outputs/<folder>/<title>/note.md  - canvas_path= <cwd>/outputs/<folder>/<title>/diagram.canvas  - base_path  = <cwd>/outputs/<folder>/<title>/table.base  - meta_path  = <cwd>/outputs/<folder>/<title>/meta.json- When writing files, use these full paths or ensure you're in the CWD
### 4) Generate and WRITE note.md (MANDATORY)
- Invoke obsidian-markdown skill using templates/note.md.prompt
- The invocation MUST include runtime context:
  - title
  - folder
  - tags
  - properties
  - root_dir (outputs/<folder>/<title>/)

- The generated markdown MUST be written to disk at:
  outputs/<folder>/<title>/note.md

### 5) Generate and WRITE diagram.canvas (CONDITIONAL)
- If "canvas" is present in artifact_plan:
  - Invoke json-canvas skill using templates/canvas.prompt
  - The invocation MUST include runtime context:
    - title
    - folder
    - artifact_plan
    - root_dir (outputs/<folder>/<title>/)

  - The generated canvas MUST be written to disk at:
    outputs/<folder>/<title>/diagram.canvas

### 6) Generate and WRITE table.base (CONDITIONAL)
- If "base" is present in artifact_plan:
  - Invoke obsidian-bases skill using templates/base.prompt
  - The invocation MUST include runtime context:
    - title
    - folder
    - artifact_plan
    - root_dir (outputs/<folder>/<title>/)

  - The generated base MUST be written to disk at:
    outputs/<folder>/<title>/table.base

### 7) Generate and WRITE meta.json (MANDATORY)
- Generate meta.json according to rules/output.contract.md
- Write meta.json to:
  outputs/<folder>/<title>/meta.json

### 8) Execution Summary
- Output a short summary listing generated files and their final paths

---

## File Writing Rules (CRITICAL)
- Every generated artifact MUST be written to disk.
- Outputting content only in the conversation is NOT allowed.
- Missing file writes invalidate the execution.

---

## Hard Constraints

### General
- artifact_plan MUST include "md"
- folder MUST be from rules/folders.md
- tags count MUST be 3–8 and include at least one domain tag

### note.md
Must include:
- YAML frontmatter (tags, category, created, modified)
- Summary section
- ≥3 structured sections
- Examples (code blocks when applicable)
- ≥5 Caveats / Notes

### diagram.canvas (if generated)
- Text nodes MUST use "type":"text" and the "text" field
- MUST NOT use "label" for text nodes
- ≥6 nodes, ≥5 edges
- Include branching and persistence step

### table.base (if generated)
- MUST scope sources to root_dir only
- MUST exclude non-markdown files
- ≥6 columns
- At least one usable view

---

## Examples
See examples/ directory:
- e2e-docker.md
- e2e-arch.md
- e2e-table.md

